#!/usr/bin/env bash

set -e

RT_HOME='/home/rosstimson'

CLEAR='\e[0m'
GREEN='\e[0;32m'
RED='\e[0;31m'

echo "Running tests..."
echo ""

symlinks=( .Xcolors \
           .Xresources \
           .abcde.conf \
           .ackrc \
           .cookiecutterrc \
           .cshrc \
           .emacs.d \
           .exrc \
           .fonts \
           .fonts.conf \
           .gemrc \
           .gitconfig \
           .gitignore \
           .hgignore \
           .hgrc \
           .inputrc \
           .irbrc \
           .irssi \
           .jshintrc \
           .login \
           .login_conf \
           .mailcap \
           .mpdconf \
           .msmtprc \
           .mutt \
           .muttrc \
           .ncmpcpp \
           .notmuch-config \
           .offlineimaprc \
           .porttools \
           .profile \
           .shrc \
           .spectrwm.conf \
           .tarignore \
           .termcap \
           .tmux.conf \
           .ttytterrc \
           .urlview \
           .urxvt-perls \
           .xinitrc \
           .xserverrc \
           .zsh \
           .zsh_nocorrect \
           .zshenv \
           .zshrc \
           bin )

directories=()

errors=()

symlink_count=${#symlinks[*]}
dir_count=${#dirs[*]}

echo "Testing symlinks..."
test_symlink_presence(){
  if [ -h ${RT_HOME}/$1 ]; then
    echo -en "${GREEN}.${CLEAR}"
  else
    echo -en "${RED}E${CLEAR}"
    errors=( "${errors[@]}" "$1" ) # Append error to array to echo later.
  fi
}

i="0"
while [ $i -lt $symlink_count ]
do
  test_symlink_presence ${symlinks[$i]}
  i=$[$i+1]
done

# List out array of errors
echo ""
echo ""
echo "ERRORS - The following dotfiles are not present:"
echo ""
echo "${errors[@]}"

